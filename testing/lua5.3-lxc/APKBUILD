# Contributor: Francesco Colista <fcolista@alpinelinux.org>
# Maintainer: Francesco Colista <fcolista@alpinelinux.org>
pkgname=lua5.3-lxc
_pkgname=lua-lxc
pkgver=3.0.0
pkgrel=0
pkgdesc="LUA binding for liblxc"
url="https://github.com/lxc/lua-lxc"
arch="all"
license="LGPL-2.1"
depends="lua5.3"
makedepends="automake autoconf libtool lua5.3-dev lxc-dev"
source="https://github.com/lxc/$_pkgname/archive/$_pkgname-$pkgver.tar.gz"
builddir="$srcdir/$_pkgname-$_pkgname-$pkgver"

prepare() {
	default_prepare
	cd "$builddir"
	./autogen.sh
}
build() {
	cd "$builddir"
	export LUA_VERSION=5.3
	./configure \
		--prefix=/usr \
		--localstatedir=/var \
		--enable-static=no \
		--with-lua-pc=lua5.3
	make
}
#  LUA_LIBS    linker flags for LUA, overriding pkg-config
#  LUA_VERSION value of V for $LUAPKGCONFIG, overriding pkg-config
check() {
	cd "$builddir"
	make check
}
package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" LUA_VERSION=5.3 install
}

sha512sums="6d0da96fb7437ac14f3010c6bbc750646352c6e60020be4b65db28b73664c2269085379f1e35db71c7b35a19933354194dd6ac656dafac24cb8f433b1ff5fabf  lua-lxc-3.0.0.tar.gz"
