# Contributor: Carlo Landmeter <clandmeter@gmail.com>
# Maintainer: Natanael Copa <ncopa@alpinelinux.org>
pkgname=accountsservice
pkgver=0.6.54
pkgrel=1
pkgdesc="D-Bus interface for user account query and manipulation"
url="https://www.freedesktop.org/software/accountsservice/"
arch="all"
license="GPL-3.0-or-later"
depends_dev="glib-dev gobject-introspection-dev polkit-dev"
makedepends="$depends_dev meson py3-setuptools"
subpackages="$pkgname-dev $pkgname-lang"
source="https://www.freedesktop.org/software/accountsservice/accountsservice-$pkgver.tar.xz
	musl-fgetspent_r.patch
	musl-wtmp.patch"
builddir="$srcdir"/$pkgname-$pkgver
build() {
	cd "$builddir"
	meson --prefix=/usr -Dsystemdsystemunitdir=no . output
	ninja -C output
}

check() {
	cd "$builddir"
	ninja -C output test
}

package() {
	cd "$builddir"
	DESTDIR="$pkgdir" ninja -C output install
}

sha512sums="5fbcccc286dba60efba905aa79b1b51a5478fe52bf2e256d40d9fc2d7a311aea4ce397365045659a4ef2ecb2cc079130fb1d0107749c3c906c394517056ac1c0  accountsservice-0.6.54.tar.xz
469392beca8f5941eafaa193c4fcb0472770ee4183ce520416a1b5d6abafe0e201990eb74d06bfbd9e20af08e55aff5f0031f267083f6c6879f0fe4e5028103c  musl-fgetspent_r.patch
e454b66026030577de635b4752c16a51dfa61188d91acb76da7497f61f11b4c773953c08947b2aac902926f847c01b1f289757ed042989a6db9c51b58dfcc2b3  musl-wtmp.patch"
