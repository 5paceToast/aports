# Contributor: Francesco Colista <fcolista@alpinelinux.org>
# Maintainer: Francesco Colista <fcolista@alpinelinux.org>
pkgname=miniupnpc
pkgver=2.0
pkgrel=1
pkgdesc="Library and tool to control NAT in UPnP-enabled routers"
url="http://miniupnp.free.fr/"
arch="all"
license="BSD"
makedepends="$depends_dev bsd-compat-headers"
subpackages="$pkgname-dev $pkgname-doc"
source="http://miniupnp.free.fr/files/miniupnpc-$pkgver.tar.gz
	CVE-2017-8798.patch"
builddir="$srcdir"/miniupnpc-$pkgver

# secfixes:
#   2.0-r1:
#     - CVE-2017-8798

build() {
	cd "$builddir"
	make || return 1
}

package() {
	cd "$builddir"
	make PREFIX="$pkgdir" install || return 1
}

sha512sums="e8bca24265086518fa3bdc25fc31371ddf878adaa2bd6a80b30f33a3e5adb831220e906302832f2250e489a73ecd7e6c9a6bfcb1c70258a90e4c4712196275de  miniupnpc-2.0.tar.gz
a3f79e4f09b1f031d2d71d125dcc5c398b24daa34d4ceb86e7d5bfae7edb80516e0d7fb052537535bfa913fb056772ed7362853827116c7885b8037d3ebde0be  CVE-2017-8798.patch"
