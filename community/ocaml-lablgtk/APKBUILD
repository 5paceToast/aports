# Contributor: Jean-Louis Fuchs <ganwell@fangorn.ch>
# Maintainer: Jean-Louis Fuchs <ganwell@fangorn.ch>
pkgname=ocaml-lablgtk
_pkgname=lablgtk
pkgver=2.18.5
pkgrel=4
pkgdesc="LablGtk - an OCaml interface to GTK+ 2.x"
url="http://lablgtk.forge.ocamlcore.org/"
# ocaml is not built for x86, armhf
arch="x86_64 ppc64le"
license="LGPL-2.1-only-WITH-linking-exception"
depends="ocaml-findlib ocaml-camlp4 ocaml"
depends_dev="lablgtk gtk+-dev gtkspell-dev librsvg-dev gtksourceview2-dev"
makedepends="$depends_dev ocaml-camlp4-dev"
replaces="lablgtk"
provides="lablgtk=$pkgver-r$pkgrel"  # for backward compatibility
subpackages="$pkgname-doc $pkgname-dev"
source="https://forge.ocamlcore.org/frs/download.php/1627/$_pkgname-$pkgver.tar.gz"
builddir="$srcdir/$_pkgname-$pkgver"
options="!check textrels"

build() {
	cd "$builddir"

	./configure --prefix=/usr
	make -j1 world
	make -j1 opt
	make doc
}

package() {
	cd "$builddir"

	make DESTDIR="$pkgdir" install
	rm -f "$pkgdir"/usr/lib/ocaml/ld.conf
}

doc() {
	default_doc

	local docdir="$subpkgdir"/usr/share/doc/$pkgname/
	mkdir -p "$docdir"
	cp -r "$builddir"/doc/html/* "$docdir"/
}

sha512sums="7b6ba1a4dfa82cc3bbc502082ff4fccc23cc06ee4f30d01a2e423f3f99e945a4befe450d230b5aa19c5b810e9f46f2838655099d49da2db7c8a2e52eac213024  lablgtk-2.18.5.tar.gz"
