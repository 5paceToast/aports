# Contributor: Sören Tempel <soeren+alpine@soeren-tempel.net>
# Maintainer: Sören Tempel <soeren+alpine@soeren-tempel.net>
pkgname=spim
pkgver=8.0
pkgrel=2
pkgdesc="Simulator for MIPS32"
url="http://spimsimulator.sourceforge.net/"
arch="all"
license="BSD"
depends=""
depends_dev=""
makedepends="bash flex bison"
install=""
subpackages="$pkgname-doc"
source="http://pages.cs.wisc.edu/~larus/SPIM/${pkgname}-${pkgver}.tar.gz
	flex-2.6-compat.patch
	respect-env.patch"

patch_args="-p0"
builddir="$srcdir"/$pkgname-$pkgver

build() {
	make configuration $pkgname \
		-C "$builddir"/$pkgname || return 1
}

package() {
	cd "$builddir"
	make DESTDIR="$pkgdir" -C $pkgname install || return 1

	install -Dm644 Documentation/spim.man \
		"$pkgdir"/usr/share/man/man1/spim.1 || return 1
	for i in ChangeLog Documentation/BLURB README VERSION; do
		install -Dm644 $i \
			"$pkgdir"/usr/share/doc/$pkgname/${i##*/} || return 1
	done
}

sha512sums="c4eb66863a931b74d6c6ecd92860d16fd6369c85caecba1e71a1149e73e708502d1070f17a9beb6d0af1368db1ee5a85c040b596866a1236275cdd410a661adf  spim-8.0.tar.gz
787df8e61cb4dd11a6dfdd217d1c990a8335d2790cd6327faf09811094821c8485bd44990c934e699a877938f81777302fdd60845ac27afbd5dc5b9b59db0132  flex-2.6-compat.patch
68e9f39bbcee4524557389fac2a617b1b588f2df7a1a807ce8a646053345b6a5f7aba6dda23d4821283783b654baa01763923cb70501a03467c5302f173383ef  respect-env.patch"
